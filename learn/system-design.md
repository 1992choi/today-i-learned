# System Design
- Inflearn > 개발자라면 꼭 알아야할 시스템디자인 완벽가이드

<br><br>

## 개념 정리
### Latency
- 요청(Request)을 보낸 시점부터 응답(Response)을 받기까지 걸리는 시간
- 네트워크 지연, 서버 처리 시간, DB 조회 시간 등 여러 구간의 시간이 합쳐진 값
- 값이 낮을수록 사용자 체감 속도가 빠름

### Throughput
- 단위 시간당 처리할 수 있는 요청(Request)의 양 
- 보통 RPS(Requests Per Second), TPS(Transactions Per Second)로 표현 
- 서버의 CPU, 메모리, 스레드 수, DB 성능 등에 영향을 받음 
- 값이 높을수록 같은 시간에 더 많은 요청을 처리 가능 
- Latency(지연 시간)와는 다른 개념으로, “얼마나 많이 처리하느냐”에 초점이 있음

### 수평확장 vs 수직확장 (Vertical vs Horizontal Scaling)
- 수직 확장(Vertical Scaling)
  - 기존 서버의 CPU, 메모리, 스펙을 업그레이드하는 방식 
  - 구조가 단순하고 관리가 쉽지만, 물리적 한계가 존재하며 비용이 급격히 증가할 수 있음 
  - 서버 1대에 의존하는 구조가 되기 쉬워 SPOF(Single Point Of Failure, 단일 장애 지점)가 발생하기 쉬움 
- 수평 확장(Horizontal Scaling)
  - 동일한 서버를 여러 대로 늘려 부하를 분산하는 방식 
  - 로드 밸런서를 통해 트래픽을 분산하며, 트래픽 증가에 유연하게 대응 가능 
  - 여러 대 중 일부가 장애가 나더라도 전체 서비스가 중단되지 않아 SPOF를 완화할 수 있음
- 비교
  - 수직 확장은 “한 대를 강하게”, 수평 확장은 “여러 대로 나누어” 처리하는 전략이며 고가용성(HA) 관점에서는 일반적으로 수평 확장이 더 유리함

### 로드밸런싱 (Load Balancing)
- 여러 서버에 트래픽을 분산시켜 부하를 고르게 나누는 기술 
- 단일 서버 과부하를 방지하고, 전체 시스템의 Throughput(처리량)을 향상시킴 
- 일부 서버에 장애가 발생해도 다른 서버로 요청을 우회시켜 가용성(Availability)을 높임 
- 대표적인 알고리즘
  - Round Robin
    - 서버에 요청을 순서대로 하나씩 번갈아가며 분배하는 방식으로, 구현이 단순하고 균등 분산에 적합함
  - Least Connections
    - 현재 활성 연결 수가 가장 적은 서버에 요청을 할당하는 방식으로, 실시간 부하 상황을 반영함
  - IP Hash
    - 클라이언트의 IP 값을 해시하여 특정 서버로 고정 매핑하는 방식으로, 세션 유지에 유리함
- 장점
  - 성능 향상
    - 트래픽을 여러 서버에 분산하여 과부하를 줄이고 전체 처리량을 높일 수 있음
  - 고가용성
    - 일부 서버에 장애가 발생해도 다른 서버가 요청을 처리하여 서비스 중단을 최소화함
  - 확장성
    - 서버를 추가하는 것만으로 처리 용량을 유연하게 늘릴 수 있어 트래픽 증가에 대응하기 용이함

### 분산시스템 (Distributed System)
- 여러 대의 서버(노드)가 네트워크를 통해 연결되어 하나의 시스템처럼 동작하는 구조 
- 각 노드는 독립적으로 동작하지만, 협력하여 하나의 서비스나 기능을 제공함 
- 확장성(Scale-out)과 고가용성(HA)을 확보하기 위해 사용됨 
- 장점
  - 확장성
    - 노드를 추가하는 방식으로 시스템 처리 용량을 수평적으로 확장할 수 있어 트래픽 증가에 유연하게 대응 가능함
  - 가용성
    - 일부 노드에 장애가 발생해도 다른 노드가 서비스를 계속 제공하여 전체 시스템 중단을 방지할 수 있음
  - 성능향상
    - 작업을 여러 노드에 분산 처리하여 병렬 수행이 가능하므로 전체 처리 속도와 처리량을 향상시킬 수 있음
- 분산시스템에서의 고려사항
  - 데이터 일관성
    - 여러 노드에 복제된 데이터가 동일한 값을 유지하도록 보장하는 특성
    - 최종적 일관성(Eventual Consistency)
      - 분산 환경에서는 네트워크 지연과 가용성 확보를 위해 모든 노드가 즉시 동일한 값을 가지도록 강제하기 어렵다.
      - 따라서 일시적으로 데이터 차이를 허용하되, 시간이 지나면 결국 모든 노드의 데이터가 동일한 상태로 수렴하도록 하는 모델이 필요하며, 이를 최종적 일관성이라고 한다.
  - 네트워크 지연
    - 노드 간 통신이 네트워크를 통해 이루어지기 때문에 요청과 응답 사이에 발생하는 지연 시간으로, 시스템 성능과 응답 속도에 직접적인 영향을 줌
  - 복잡한 장애처리
    - 일부 노드나 네트워크 구간에서만 장애가 발생하는 부분 장애 상황이 빈번하므로, 이를 전제로 한 장애 감지와 복구 전략이 필요함
    - 하트비트(Heartbeat)
      - 분산 환경에서는 특정 노드가 단순히 느린 것인지, 실제로 장애가 발생한 것인지 구분해야 한다.
      - 이를 위해 각 노드는 주기적으로 자신의 상태를 알리는 신호를 보내며, 이 신호가 일정 시간 동안 감지되지 않으면 장애로 판단한다.
      - 이러한 장애 감지 메커니즘을 하트비트라고 하며, 자동 장애 조치와 서비스 지속성을 위해 필수적인 요소이다.